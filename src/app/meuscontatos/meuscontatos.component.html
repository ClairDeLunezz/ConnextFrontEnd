<div class="container mt-4" style="max-width: 700px;">
  <input 
    type="text" 
    class="form-control mb-3" 
    placeholder="Pesquisar contato..."
    [(ngModel)]="termoBusca" 
    (input)="pesquisar()">
</div>

<div *ngIf="isEditing" class="container p-4 rounded mt-5 mb-5" style="max-width: 700px; background-color: #1E1E2F; color: #E0E0E0;">
  <h2 class="text-center mb-4" style="color: #3F8CFF;">Editar Contato</h2>
  <form [formGroup]="formGroupContato">
    
    <div class="row">
      <div class="col-md-6 mb-3">
        <label for="nome" class="form-label" style="color: #A0A0A0;">Nome completo</label>
        <input formControlName="nome" type="text" class="form-control bg-dark text-light border-0" id="nome" [ngClass]="{ 'is-invalid': f['nome'].touched && f['nome'].errors }">
        <div *ngIf="f['nome'].touched && f['nome'].errors" class="invalid-feedback">
    <div *ngIf="f['nome'].errors?.['required']">O nome é obrigatório.</div>
  </div>
      </div>
      <div class="col-md-6 mb-3">
        <label for="apelido" class="form-label" style="color: #A0A0A0;">Apelido</label>
        <input formControlName="apelido" type="text" class="form-control bg-dark text-light border-0" id="apelido">
      </div>
    </div>

    <div class="row">
      <div class="col-md-6 mb-3">
        <label for="telefone" class="form-label" style="color: #A0A0A0;">Telefone</label>
        <input formControlName="telefone" type="text" class="form-control bg-dark text-light border-0" id="telefone" placeholder="(11) 91234-5678"
    mask="(00) 00000-0000" [dropSpecialCharacters]="false" [ngClass]="{ 'is-invalid': f['telefone'].touched && f['telefone'].errors }">
     <div *ngIf="f['telefone'].touched && f['telefone'].errors" class="invalid-feedback">
    <div *ngIf="f['telefone'].errors?.['required']">O telefone é obrigatório.</div>
    <div *ngIf="f['telefone'].errors?.['minlength']">O telefone está incompleto.</div>
  </div>
      </div>
      <div class="col-md-6 mb-3">
        <label for="email" class="form-label" style="color: #A0A0A0;">Email</label>
        <input formControlName="email" type="email" class="form-control bg-dark text-light border-0" id="email">
      </div>
    </div>

    <div class="mb-3">
      <label for="endereco" class="form-label" style="color: #A0A0A0;">Endereço</label>
      <input formControlName="endereco" type="text" class="form-control bg-dark text-light border-0" id="endereco">
    </div>

    <div class="row">
      <div class="col-md-6 mb-3">
        <label for="aniversario" class="form-label" style="color: #A0A0A0;">Data de Nascimento</label>
        <input formControlName="aniversario" type="date" class="form-control bg-dark text-light border-0" id="aniversario">
      </div>
      <div class="col-md-6 mb-3">
        <label for="categoria" class="form-label" style="color: #A0A0A0;">Categoria</label>
        <select formControlName="categoria" class="form-select bg-dark text-light border-0" id="categoria">
          <option selected disabled value="">Selecione uma categoria</option>
          <option value="trabalho">Trabalho</option>
          <option value="faculdade">Faculdade</option>
          <option value="família">Família</option>
          <option value="amigos">Amigos</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div class="col-md-4 mb-3">
        <label for="genero" class="form-label" style="color: #A0A0A0;">Gênero</label>
        <input formControlName="genero" type="text" class="form-control bg-dark text-light border-0" id="genero">
      </div>
      <div class="col-md-4 mb-3">
        <label for="profissao" class="form-label" style="color: #A0A0A0;">Profissão</label>
        <input formControlName="profissao" type="text" class="form-control bg-dark text-light border-0" id="profissao">
      </div>
      <div class="col-md-4 mb-3">
        <label for="nacionalidade" class="form-label" style="color: #A0A0A0;">Nacionalidade</label>
        <input formControlName="nacionalidade" type="text" class="form-control bg-dark text-light border-0" id="nacionalidade">
      </div>
    </div>

    <div class="form-check my-4">
      <input class="form-check-input" type="checkbox" formControlName="favorito" id="favorito">
      <label class="form-check-label" for="favorito" style="color: #A0A0A0;">
        Favorito ⭐
      </label>
    </div>
    
    <div class="d-flex justify-content-between">
      <button type="submit" class="btn" style="background-color: #3F8CFF; color: white;" (click)="update()"[disabled]="formGroupContato.invalid">Atualizar</button>
      <button type="button" class="btn btn-secondary" (click)="clear()">Cancelar</button>
    </div>
  </form>
</div>

<div class="tables-container">

  <div *ngIf="!pesquisaAtiva">
    <div class="container">
      <h2 class="text-center mt-5">Contatos Cadastrados</h2>
      <div class="table-responsive">
        <table class="table table-striped mt-3">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Apelido</th>
              <th>Telefone</th>
              <th>Email</th>
              <th>Endereço</th>
              <th>Aniversário</th>
              <th>Categoria</th>
              <th>Favorito</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let c of contatos">
              <td data-label="Nome">{{ c.nome }}</td>
              <td data-label="Apelido">{{ c.apelido }}</td>
              <td data-label="Telefone">{{ c.telefone }}</td>
              <td data-label="Email">{{ c.email }}</td>
               <td data-label="Email">{{ c.endereco }}</td>
              <td data-label="Aniversário">{{ c.aniversario | date:'dd/MM/yyyy' }}</td>
              <td data-label="Categoria">{{ c.categoria }}</td>
              <td data-label="Favorito" class="text-center">
                <span [ngClass]="{'text-warning': c.favorito, 'text-muted': !c.favorito}" style="font-size: 1.5rem;">
                  {{ c.favorito ? '★' : '☆' }}
                </span>
              </td>
              <td data-label="Ações">
                <button class="btn btn-primary btn-sm me-2 mb-1" (click)="onClickupdate(c)">Editar</button>
                <button class="btn btn-danger btn-sm mb-1" (click)="delete(c)">Remover</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div *ngIf="pesquisaAtiva">
    <div class="container">
      <h2 class="text-center mt-5">Resultados da Pesquisa</h2>
      <div class="table-responsive">
        <table class="table table-striped table-hover mt-3">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Apelido</th>
              <th>Telefone</th>
              <th>Email</th>
              <th>Endereço</th>
              <th>Aniversário</th>
              <th>Categoria</th>
              <th>Favorito</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let c of contatosFiltrados">
              <td data-label="Nome">{{ c.nome }}</td>
              <td data-label="Apelido">{{ c.apelido }}</td>
              <td data-label="Telefone">{{ c.telefone }}</td>
              <td data-label="Email">{{ c.email }}</td>
              <td data-label="Email">{{ c.endereco }}</td>
              <td data-label="Aniversário">{{ c.aniversario | date:'dd/MM/yyyy' }}</td>
              <td data-label="Categoria">{{ c.categoria }}</td>
              <td data-label="Favorito" class="text-center">
                <span [ngClass]="{'text-warning': c.favorito, 'text-muted': !c.favorito}" style="font-size: 1.5rem;">
                  {{ c.favorito ? '★' : '☆' }}
                </span>
              </td>
              <td data-label="Ações">
                <button class="btn btn-primary btn-sm me-2 mb-1" (click)="onClickupdate(c)">Editar</button>
                <button class="btn btn-danger btn-sm mb-1" (click)="delete(c)">Remover</button>
              </td>
            </tr>
            <tr *ngIf="contatosFiltrados.length === 0">
              <td colspan="8" class="text-center text-muted">Nenhum contato encontrado.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

</div>